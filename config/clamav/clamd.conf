##
## ClamAV Daemon Configuration
## macOS optimized settings
##

# Path to the database directory
DatabaseDirectory /opt/homebrew/var/lib/clamav

# Path to the log file
LogFile /opt/homebrew/var/log/clamav/clamd.log

# Log time with each message
LogTime yes

# Log additional information about the infected file
ExtendedDetectionInfo yes

# Path to a local socket file the daemon will listen on
LocalSocket /opt/homebrew/var/run/clamav/clamd.sock

# Sets the permissions on the unix socket to the specified mode
LocalSocketMode 660

# Maximum number of threads running at the same time
MaxThreads 12

# Maximum directory recursion level
MaxDirectoryRecursion 20

# Follow directory symlinks
FollowDirectorySymlinks yes

# Follow regular file symlinks
FollowFileSymlinks yes

# Scan files and directories on other filesystems
CrossFilesystems yes

# Maximum size of a file to scan
MaxFileSize 100M

# Maximum size of a file to scan in an archive
MaxScanSize 300M

# Maximum files to scan in an archive
MaxFiles 10000

# Maximum recursion in archives
MaxRecursion 16

# Enable scanning of mail files
ScanMail yes

# Enable scanning of PDF files
ScanPDF yes

# Enable scanning of SWF files
ScanSWF yes

# Enable scanning of XML files
ScanXMLDOCS yes

# Enable scanning of HWP3 files
ScanHWP3 yes

# Enable scanning of archive files
ScanArchive yes

# Alert on encrypted archives
AlertEncrypted no

# Alert on encrypted documents
AlertEncryptedDoc no

# Alert on OLE2 files with VBA macros
AlertOLE2Macros no

# Alert on files that exceed max file size, max scan size, or max recursion limit
AlertExceedsMax no

# Enable heuristic alerts
HeuristicAlerts yes

# Heuristic scan precedence
HeuristicScanPrecedence yes

# Enable potentially unwanted application detection
DetectPUA yes

# Exclude a specific PUA category
ExcludePUA NetTool
ExcludePUA PWTool

# Enable algorithmic detection of PE files
AlgorithmicDetection yes

# PE files - alerts on broken executables
AlertBrokenExecutables yes

# Mark encrypted archives as viruses
ArchiveBlockEncrypted no

# Maximum number of partitions to scan
MaxPartitions 50

# Enable on-access scanning (requires additional setup)
# ScanOnAccess yes

# Set the include paths for on-access scanning
# OnAccessIncludePath /Users
# OnAccessExcludePath /Users/*/Library

# Disable caching of scan results
DisableCertCheck yes

# User to run the daemon as
User _clamav

# Bytecode security level
BytecodeSecurity TrustSigned

# Timeout for bytecode execution
BytecodeTimeout 60000
